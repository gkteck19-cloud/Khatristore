<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KHATRI STORE - ‡§™‡•ç‡§∞‡•ã ‡§∂‡•â‡§™</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .promo-banner { background: linear-gradient(90deg, #f97316, #ea580c); animation: slide 20s linear infinite; }
        @keyframes slide { from { transform: translateX(100%); } to { transform: translateX(-100%); } }
        .line-clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
    </style>
</head>
<body class="bg-gray-50 text-slate-900 font-sans">

    <div class="overflow-hidden bg-orange-600 text-white py-1 text-[10px] font-bold uppercase tracking-widest relative z-[110]">
        <div class="promo-banner whitespace-nowrap">
            üî• ‡§Ü‡§ú ‡§ï‡§æ ‡§Æ‡§π‡§æ ‡§ß‡§Æ‡§æ‡§ï‡§æ: ‡§∏‡§≠‡•Ä ‡§ï‡•â‡§™‡§∞ ‡§µ‡§æ‡§Ø‡§∞ ‡§™‡§∞ 10% ‡§ï‡•Ä ‡§≠‡§æ‡§∞‡•Ä ‡§õ‡•Ç‡§ü! ‚Ä¢ ‡§´‡•ç‡§∞‡•Ä ‡§°‡§ø‡§≤‡•Ä‡§µ‡§∞‡•Ä ‡§™‡§Ç‡§°‡§∞‡§ø‡§Ø‡§æ ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‚Ä¢ ‡§®‡§Ø‡§æ ‡§ï‡•Ç‡§≤‡§∞ ‡§∏‡•ç‡§ü‡•â‡§ï ‡§Ü ‡§ó‡§Ø‡§æ ‡§π‡•à ‚Ä¢ ‡§Æ‡§æ‡§Ç ‡§≠‡§ó‡§µ‡§§‡•Ä ‡§á‡§≤‡•á‡§ï‡•ç‡§ü‡•ç‡§∞‡§ø‡§ï‡§≤ ‡§™‡§∞ ‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à üî•
        </div>
    </div>

    <nav class="bg-slate-900 text-white p-4 sticky top-0 z-[100] flex justify-between items-center shadow-md">
        <h1 class="text-xl font-black italic text-orange-400 tracking-tighter uppercase">Khatri Store</h1>
        <div class="relative cursor-pointer" onclick="toggleCart()">
            <i data-lucide="shopping-cart"></i>
            <span id="cart-count" class="absolute -top-2 -right-2 bg-orange-500 text-[10px] w-4 h-4 rounded-full flex items-center justify-center font-bold">0</span>
        </div>
    </nav>

    <div class="bg-slate-900 text-white px-4 pb-12 pt-4 text-center relative mb-10">
        <div class="max-w-md mx-auto relative text-slate-900">
            <i data-lucide="search" class="absolute left-4 top-4 text-gray-400 w-4 h-4"></i>
            <input type="text" oninput="handleSearch(this.value.toLowerCase())" placeholder="‡§∏‡§æ‡§Æ‡§æ‡§® ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§ñ‡•ã‡§ú‡•á‡§Ç..." class="w-full bg-white py-4 pl-12 pr-4 rounded-2xl shadow-xl outline-none text-sm font-bold border-none">
        </div>
    </div>

    <div class="px-4 mb-8">
        <h2 class="font-black text-sm uppercase mb-3 flex items-center gap-2 italic">
            <i data-lucide="trending-up" class="text-orange-500 w-4 h-4"></i> Top Selling Products
        </h2>
        <div id="top-selling" class="flex gap-3 overflow-x-auto no-scrollbar pb-2">
            </div>
    </div>

    <div id="cat-bar" class="flex gap-2 overflow-x-auto no-scrollbar px-4 mb-6 sticky top-16 bg-gray-50/90 backdrop-blur-sm py-2 z-50">
        </div>

    <div id="product-grid" class="max-w-7xl mx-auto px-4 grid grid-cols-2 gap-3 mb-10"></div>

    <div class="bg-slate-100 p-6 mb-24 rounded-t-[40px]">
        <h2 class="font-black text-xs uppercase mb-4 text-center tracking-widest">‡§ó‡•ç‡§∞‡§æ‡§π‡§ï ‡§ï‡•ç‡§Ø‡§æ ‡§ï‡§π‡§§‡•á ‡§π‡•à‡§Ç?</h2>
        <div class="space-y-4">
            <div class="bg-white p-4 rounded-2xl shadow-sm italic text-[11px]">
                <div class="flex text-orange-400 mb-1"><i data-lucide="star" class="w-3 h-3 fill-orange-400"></i><i data-lucide="star" class="w-3 h-3 fill-orange-400"></i><i data-lucide="star" class="w-3 h-3 fill-orange-400"></i><i data-lucide="star" class="w-3 h-3 fill-orange-400"></i><i data-lucide="star" class="w-3 h-3 fill-orange-400"></i></div>
                "‡§™‡§Ç‡§°‡§∞‡§ø‡§Ø‡§æ ‡§Æ‡•á‡§Ç ‡§∏‡§¨‡§∏‡•á ‡§¨‡•ù‡§ø‡§Ø‡§æ ‡§∞‡•á‡§ü ‡§î‡§∞ ‡§ï‡•ç‡§µ‡§æ‡§≤‡§ø‡§ü‡•Ä‡•§ ‡§Æ‡•à‡§Ç‡§®‡•á ‡§á‡§Ç‡§°‡§ï‡•ç‡§∂‡§® ‡§≤‡§ø‡§Ø‡§æ ‡§•‡§æ, ‡§¨‡§π‡•Å‡§§ ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§ö‡§≤ ‡§∞‡§π‡§æ ‡§π‡•à‡•§" 
                <p class="font-bold mt-2 text-slate-400">‚Äî ‡§∞‡§æ‡§ú‡•á‡§∂ ‡§∏‡§æ‡§π‡•Ç, ‡§™‡§Ç‡§°‡§∞‡§ø‡§Ø‡§æ</p>
            </div>
            <div class="bg-white p-4 rounded-2xl shadow-sm italic text-[11px]">
                <div class="flex text-orange-400 mb-1"><i data-lucide="star" class="w-3 h-3 fill-orange-400"></i><i data-lucide="star" class="w-3 h-3 fill-orange-400"></i><i data-lucide="star" class="w-3 h-3 fill-orange-400"></i><i data-lucide="star" class="w-3 h-3 fill-orange-400"></i><i data-lucide="star" class="w-3 h-3 fill-orange-400"></i></div>
                "‡§ñ‡§§‡•ç‡§∞‡•Ä ‡§∏‡•ç‡§ü‡•ã‡§∞ ‡§ï‡§æ ‡§µ‡•ç‡§Ø‡§µ‡§π‡§æ‡§∞ ‡§¨‡§π‡•Å‡§§ ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§π‡•à‡•§ ‡§∏‡§æ‡§Æ‡§æ‡§® ‡§ñ‡§∞‡§æ‡§¨ ‡§π‡•ã‡§®‡•á ‡§™‡§∞ ‡§§‡•Å‡§∞‡§Ç‡§§ ‡§¨‡§¶‡§≤ ‡§ï‡§∞ ‡§¶‡•á‡§§‡•á ‡§π‡•à‡§Ç‡•§" 
                <p class="font-bold mt-2 text-slate-400">‚Äî ‡§∏‡•Å‡§®‡•Ä‡§≤ ‡§¶‡•á‡§µ‡§æ‡§Ç‡§ó‡§®</p>
            </div>
        </div>
    </div>

    <div id="login-modal" class="fixed inset-0 bg-black/80 z-[200] hidden flex items-center justify-center p-6">...</div>
    <div id="cart-drawer" class="fixed inset-0 bg-black/50 z-[150] hidden flex justify-end">...</div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, onValue, push, set } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // Firebase Config (Same as before)
        const firebaseConfig = {
            apiKey: "AIzaSyBhNDgsAtOsxdfNGfTEqbuQoYgbtTjUSVo",
            authDomain: "khatri-online.firebaseapp.com",
            databaseURL: "https://khatri-online-default-rtdb.firebaseio.com",
            projectId: "khatri-online",
            storageBucket: "khatri-online.firebasestorage.app",
            messagingSenderId: "117940742720",
            appId: "1:117940742720:web:5d7dce7c186199e9fbcda5"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        let cart = [], allProducts = {}, currentCat = "All", searchTerm = "";

        onValue(ref(db, 'products'), (snap) => {
            allProducts = snap.val() || {};
            renderUI();
            renderTopSelling();
        });

        // ‡§∏‡§¨‡§∏‡•á ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§¨‡§ø‡§ï‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§∏‡§æ‡§Æ‡§æ‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§≤‡•â‡§ú‡§ø‡§ï
        function renderTopSelling() {
            let html = "";
            let count = 0;
            for(let id in allProducts) {
                const p = allProducts[id];
                if(count < 5) { // ‡§ï‡•á‡§µ‡§≤ ‡§™‡§π‡§≤‡•á 5 ‡§∏‡§æ‡§Æ‡§æ‡§®
                    html += `
                        <div onclick="addToCart('${id}', '${p.name}', ${p.price})" class="min-w-[120px] bg-white p-2 rounded-2xl border border-orange-100 shadow-sm relative overflow-hidden">
                            <span class="absolute top-0 right-0 bg-orange-500 text-white text-[7px] px-2 py-0.5 rounded-bl-lg font-bold">BEST</span>
                            <img src="${p.image}" class="h-16 w-full object-contain mb-1">
                            <p class="text-[8px] font-bold line-clamp-1 uppercase">${p.name}</p>
                            <p class="text-[10px] font-black text-orange-600">‚Çπ${p.price}</p>
                        </div>`;
                    count++;
                }
            }
            document.getElementById('top-selling').innerHTML = html;
        }

        // renderUI, handleSearch, addToCart ‡§µ‡§π‡•Ä ‡§∞‡§π‡•á‡§Ç‡§ó‡•á...
        // [‡§Ø‡§π‡§æ‡§Å ‡§™‡•Å‡§∞‡§æ‡§®‡§æ ‡§≤‡•â‡§ú‡§ø‡§ï ‡§ú‡•ã ‡§™‡§ø‡§õ‡§≤‡•á ‡§ï‡•ã‡§° ‡§Æ‡•á‡§Ç ‡§•‡§æ ‡§µ‡§π‡•Ä ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡•á‡§ó‡§æ]
        
        lucide.createIcons();
    </script>
</body>
</html>
lack">‚Çπ${i.price}</b></div>`;
            }).join('');
            document.getElementById('cart-total').innerText = `‚Çπ${total}`;
        }

        window.initiateOrder = () => {
            if(cart.length === 0) return alert("‡§ï‡§æ‡§∞‡•ç‡§ü ‡§ñ‡§æ‡§≤‡•Ä ‡§π‡•à!");
            const savedUser = localStorage.getItem('khatri_user');
            if(savedUser) { processOrder(); } 
            else { document.getElementById('login-modal').classList.remove('hidden'); }
        };

        window.closeLogin = () => document.getElementById('login-modal').classList.add('hidden');

        window.processOrder = async () => {
            let user = JSON.parse(localStorage.getItem('khatri_user'));
            if(!user) {
                const name = document.getElementById('cust-name').value;
                const phone = document.getElementById('cust-phone').value;
                if(name && phone.length >= 10) {
                    user = { name, phone };
                    localStorage.setItem('khatri_user', JSON.stringify(user));
                } else { return alert("‡§®‡§æ‡§Æ ‡§î‡§∞ ‡§∏‡§π‡•Ä ‡§®‡§Ç‡§¨‡§∞ ‡§≠‡§∞‡•á‡§Ç!"); }
            }

            try {
                const orderData = {
                    customer: user,
                    items: cart,
                    total: cart.reduce((s, i) => s + i.price, 0),
                    createdAt: Date.now(),
                    status: 'New'
                };
                await push(ref(db, 'orders'), orderData);
                alert("‡§∂‡•Å‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ " + user.name + "! ‡§Ü‡§™‡§ï‡§æ ‡§Ü‡§∞‡•ç‡§°‡§∞ ‡§ñ‡§§‡•ç‡§∞‡•Ä ‡§∏‡•ç‡§ü‡•ã‡§∞ ‡§Æ‡•á‡§Ç ‡§¶‡§∞‡•ç‡§ú ‡§π‡•ã ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§");
                cart = []; updateCartUI(); toggleCart(); closeLogin();
            } catch (e) { alert(e.message); }
        };

        lucide.createIcons();
    </script>
</body>
</html>
